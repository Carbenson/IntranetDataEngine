"use strict";var MyModals;!function(e){var t,o=function(){function e(e,t){var o=this;if(""!==e&&""!==t){var n=document.getElementById(e);if(null!==n){this.modal=n;$("#"+e+" .close-modal").on("click",function(){o.hide()});var a=document.getElementById(t);null!==a?this.mask=a:console.error("can not find maskId = "+t)}else console.error("can not find modalId = "+e)}}return e.prototype.show=function(){this.mask.style.display="block",this.modal.style.display="block"},e.prototype.hide=function(){this.modal.style.display="none",this.mask.style.display="none"},e.prototype.removeSelf=function(){void 0!==this.modal&&this.modal.remove()},e}();!function(e){var t=function(){return function(){}}(),a=function(){return function(){}}(),d=function(){return function(){this.listRecord=[],this.listModel=[]}}(),l={initData:new d,htmlModal:"",modalNode:new o("",""),textarea:document.getElementById("textarea_sms_content"),btnConfirmSendSms:$("#btn_confirm_send_sms"),spanLeftWordCount:$("#left_word_count_sms_content")[0],divContainerSmsRecord:$("#sms_record")[0],divContainerSmsModel:$("#model_container_sms")[0]};e.init=function(){r(),s()};var s=function(){var e=function(){var e=new d,o=new a;o.id=1,o.content="恭喜发财！";var n=new a;n.id=2,n.content="身体健康！",e.listModel.push(o),e.listModel.push(n);var l=new t;l.dateTime="2017-11-01 14 : 34",l.record="您是否换了电话",l.recordType=1;var s=new t;s.dateTime="2017-11-03 13：25",s.record="客户表示家人在光大证券做的，要求转去支持，客户不想多个账户，要全部转走后来因为升位，没有转走，挽留客户给了0.6的费率优惠，安抚客户",s.recordType=2;var i=new t;return i.dateTime="2017-11-04 13：25",i.record="好哇",i.recordType=1,e.listRecord.push(l),e.listRecord.push(s),e.listRecord.push(i),e}();l.initData=e,i(),m()},i=function(){_(),document.body.insertAdjacentHTML("beforeend",l.htmlModal),l.divContainerSmsRecord=$("#sms_record")[0],$(l.divContainerSmsRecord).slimScroll({height:"215px;",start:"bottom"}),l.textarea=document.getElementById("textarea_sms_content"),l.divContainerSmsModel=$("#model_container_sms")[0],l.initData.listRecord.forEach(function(t){e.addRecordHtml(t)}),l.initData.listModel.forEach(function(t){e.addModelHtml(t)}),n.init(l.initData.listModel.length);var t=new o("modal_send_sms","mask1");l.modalNode=t},r=function(){l.modalNode.removeSelf()},m=function(){var e=document.getElementById("btn_send_sms");null!==e&&(e.onclick=function(){l.textarea.value="",u(),l.modalNode.show(),c()}),l.btnConfirmSendSms=$("#btn_confirm_send_sms"),l.btnConfirmSendSms.on("click",function(){var e=l.textarea.value.trim();if(e.length>0&&e.length<=63){var o=new t;o.record=e,o.recordType=2,o.dateTime=(new Date).toLocaleString(),f(o)}}),l.spanLeftWordCount=$("#left_word_count_sms_content")[0],l.textarea.oninput=function(){u()}},c=function(){$(l.divContainerSmsRecord).slimScroll({scrollTo:"215px;"})},u=function(){var e=l.textarea.value.trim();e.length>0&&e.length<=63?l.btnConfirmSendSms.removeClass("disabled"):l.btnConfirmSendSms.addClass("disabled"),l.spanLeftWordCount.innerText=(63-e.length).toString()},_=function(){var e=['<div id="modal_send_sms">','    <div class="content">','        <p class="p-header">发送短信</p>','        <div id="sms_record">',"        </div>",'        <textarea id="textarea_sms_content" class="font-size-16" placeholder="请输入短信内容......"></textarea>','        <span class="input-footer">剩余字数：','            <span id="left_word_count_sms_content" class="text-number">63</span>',"        </span>",'        <div class="row modal-tool-bar">','            <div class="col-50" style="text-align:right">','                <button id="btn_confirm_send_sms" type="button" class="btn disabled" style="margin-right: 10px;">发送</button>',"            </div>",'            <div class="col-50 tool-bar">','                <button id="btn_cancel_send_sms" type="button" class="btn close-modal" style="margin-left: 10px;">取消</button>',"                <p>（点此添加短信模板）",'                    <i id="btn_create_sms_model" class="icon-plus"></i>',"                </p>","            </div>","        </div>",'        <div id="model_container_sms">',"        </div>","    </div>","</div>"].join("");l.htmlModal=e};e.addRecordHtml=function(e){var t=function(e){var t="";return 1===e.recordType?t=['<div class="record-1">',"    <p>"+e.dateTime+"</p>","    <div>"+e.record+"</div>","</div>"].join(""):2===e.recordType&&(t=['<div class="record-2">',"    <p>"+e.dateTime+"</p>","    <div>"+e.record+"</div>","</div>"].join("")),t}(e);l.divContainerSmsRecord.insertAdjacentHTML("beforeend",t)},e.addModelHtml=function(e){var t=function(e){return['<div id="sms_model_'+e.id+'" class="row">','    <div class="model-sms">',"        "+e.content,'        <div class="hover-show">','            <div class="triangle"></div>',"            "+e.content,"        </div>","    </div>",'    <i class="icon-close"></i>',"</div>"].join("")}(e);l.divContainerSmsModel.insertAdjacentHTML("beforeend",t);var o=$(l.divContainerSmsModel).find("#sms_model_"+e.id)[0],n=$(o).find(".model-sms");n.data("data",e),n.on("click",function(){var e=n.data("data");l.textarea.value=e.content,u()}),$(o).find(".icon-close").on("click",function(){v(e,o)})},e.addModelData=function(e){l.initData.listModel.push(e)};var v=function(e,t){for(var o=0;o<l.initData.listModel.length;o++)if(l.initData.listModel[o].id===e.id){l.initData.listModel.splice(o,1),n.addExistModelCount(-1);break}t.remove()},f=function(t){e.addRecordHtml(t),c(),l.textarea.value="",u()}}(t=e.modal_send_sms||(e.modal_send_sms={}));var n;!function(e){var n={htmlModal:"",htmlModalAlert:"",modalNode:new o("",""),modalAlertNode:new o("",""),existModelCount:0,textarea:document.getElementById("textarea_sms_model"),btnSaveCreateSmsModel:$("#btn_save_create_sms_model"),spanLeftWordCount:$("#left_word_count_sms_model")[0]};e.init=function(t){e.addExistModelCount(t),d(),a(),l()},e.addExistModelCount=function(e){n.existModelCount=n.existModelCount+e};var a=function(){s(),document.body.insertAdjacentHTML("beforeend",n.htmlModal);var e=new o("modal_create_sms_model","mask2");n.modalNode=e,n.textarea=document.getElementById("textarea_sms_model"),i(),document.body.insertAdjacentHTML("beforeend",n.htmlModalAlert);var t=new o("modal_alert1","mask2");n.modalAlertNode=t},d=function(){n.modalNode.removeSelf(),n.modalAlertNode.removeSelf()},l=function(){$("#btn_create_sms_model").on("click",function(){n.existModelCount<5?(n.textarea.value="",r(),n.modalNode.show()):n.modalAlertNode.show()}),n.btnSaveCreateSmsModel=$("#btn_save_create_sms_model"),n.btnSaveCreateSmsModel.on("click",function(){var e=n.textarea.value.trim();e.length>0&&e.length<=63&&m(e)}),n.spanLeftWordCount=$("#left_word_count_sms_model")[0],n.textarea.oninput=function(){r()}},s=function(){var e=['<div id="modal_create_sms_model">','    <div class="content">','        <p class="p-header">编辑短信模板</p>','        <textarea id="textarea_sms_model" class="font-size-16" placeholder="请输入短信模板内容......"></textarea>','        <span class="input-footer">剩余字数：','            <span id="left_word_count_sms_model" class="text-number">63</span>',"        </span>",'        <div class="row modal-tool-bar">','            <div class="col-50" style="text-align:right">','                <button id="btn_save_create_sms_model" type="button" class="btn disabled" style="margin-right: 10px;">保存</button>',"            </div>",'            <div class="col-50">','                <button id="btn_cancel_create_sms_model" type="button" class="btn close-modal" style="margin-left: 10px;">取消</button>',"            </div>","        </div>","    </div>","</div>"].join("");n.htmlModal=e},i=function(){var e=['<div id="modal_alert1">','    <div class="content">','        <p class="p-header">短信模板已满</p>','        <div class="modal-alert-info">短信模板最多允许编辑5条，如需增加，请删除不用的模板</div>','        <div class="row modal-tool-bar">','            <div class="col-100" style="text-align:center">','                <button id="btn_dismiss_modal_alert1" type="button" class="btn btn-confirm close-modal">确定</button>',"            </div>","        </div>","    </div>","</div>"].join("");n.htmlModalAlert=e},r=function(){var e=n.textarea.value.trim();e.length>0&&e.length<=63?n.btnSaveCreateSmsModel.removeClass("disabled"):n.btnSaveCreateSmsModel.addClass("disabled"),n.spanLeftWordCount.innerText=(63-e.length).toString()},m=function(e){n.existModelCount=n.existModelCount+1;var o={content:e,id:(new Date).getTime()};t.addModelData(o),t.addModelHtml(o),n.modalNode.hide()}}(n=e.modal_create_sms_model||(e.modal_create_sms_model={}));!function(e){var t={htmlModal:"",modalNode:new o("",""),htmlModalAlert:"",modalAlertNode:new o("",""),textarea:document.getElementById("textarea_sms_model"),btnSaveCreateRemarkModel:$("#btn_save_create_remark_model"),spanLeftWordCount:$("#left_word_count_remark_model")[0],existModelCount:0};e.init=function(t){e.addExistModelCount(t),n(),a(),d()},e.addExistModelCount=function(e){t.existModelCount=t.existModelCount+e};var n=function(){t.modalNode.removeSelf(),t.modalAlertNode.removeSelf()},a=function(){l(),document.body.insertAdjacentHTML("beforeend",t.htmlModal);var e=new o("modal_create_remark_model","mask1");t.modalNode=e,t.textarea=document.getElementById("textarea_remark_model"),s(),document.body.insertAdjacentHTML("beforeend",t.htmlModalAlert);var n=new o("modal_alert2","mask1");t.modalAlertNode=n},d=function(){$("#btn_create_remark_model").on("click",function(){t.existModelCount<5?(t.textarea.value="",i(),t.modalNode.show()):t.modalAlertNode.show()}),t.btnSaveCreateRemarkModel=$("#btn_save_create_remark_model"),t.btnSaveCreateRemarkModel.on("click",function(){var e=t.textarea.value.trim();e.length>0&&e.length<=30&&r(e)}),t.spanLeftWordCount=$("#left_word_count_remark_model")[0],t.textarea.oninput=function(){i()}},l=function(){var e=['<div id="modal_create_remark_model">','    <div class="content">','        <p class="p-header">编辑备注模板</p>','        <textarea id="textarea_remark_model" class="font-size-16" placeholder="请输入备注模板内容......"></textarea>','        <span class="input-footer">剩余字数：','            <span id="left_word_count_remark_model" class="text-number">30</span>',"        </span>",'        <div class="row modal-tool-bar">','            <div class="col-50" style="text-align:right">','                <button id="btn_save_create_remark_model" type="button" class="btn disabled" style="margin-right: 10px;">保存</button>',"            </div>",'            <div class="col-50">','                <button id="btn_cancel_create_remark_model" type="button" class="btn close-modal" style="margin-left: 10px;">取消</button>',"            </div>","        </div>","    </div>","</div>"].join("");t.htmlModal=e},s=function(){var e=['<div id="modal_alert2">','    <div class="content">','        <p class="p-header">备注模板已满</p>','        <div class="modal-alert-info">备注模板最多允许编辑5条，如需增加，请删除不用的模板</div>','        <div class="row modal-tool-bar">','            <div class="col-100" style="text-align:center">','                <button id="btn_dismiss_modal_alert2" type="button" class="btn btn-confirm close-modal">确定</button>',"            </div>","        </div>","    </div>","</div>"].join("");t.htmlModalAlert=e},i=function(){var e=t.textarea.value.trim();e.length>0&&e.length<=30?t.btnSaveCreateRemarkModel.removeClass("disabled"):t.btnSaveCreateRemarkModel.addClass("disabled"),t.spanLeftWordCount.innerText=(30-e.length).toString()},r=function(e){t.existModelCount=t.existModelCount+1;var o={id:(new Date).getTime(),remark:e};customer_selector.TabRemark.addModelData(o),customer_selector.TabRemark.addModelHtml(o),t.modalNode.hide()}}(e.modal_create_remark_model||(e.modal_create_remark_model={}))}(MyModals||(MyModals={}));