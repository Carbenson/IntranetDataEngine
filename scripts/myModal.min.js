"use strict";var modal_send_sms,Modal=function(){function e(e,t){if(""!==e&&""!==t){var o=document.getElementById(e);if(null!==o){this.modal=o;var n=document.getElementById(t);null!==n?this.mask=n:console.error("can not find maskId = "+t)}else console.error("can not find modalId = "+e)}}return e.prototype.show=function(){this.mask.style.display="block",this.modal.style.display="block"},e.prototype.hide=function(){this.modal.style.display="none",this.mask.style.display="none"},e.prototype.removeSelf=function(){void 0!==this.modal&&this.modal.remove()},e}();!function(e){var t=function(){return function(){}}(),o=function(){return function(){}}(),n={initData:new o,htmlRecord:"",htmlModel:"",htmlModal:"",modalNode:new Modal("","")};e.init=function(){s(),d()};var d=function(){$.ajax({type:"get",url:"https://api.aichallenger.com:9080/tcapp/hq/zx.do?code=000001.1",dataType:"jsonp",contentType:"application/json",success:function(e){var d=function(){var e=new o;e.listModel=["123","456"],e.listRecord=[];var n=new t;n.dateTime="2017-11-01 14 : 34",n.record="您是否换了电话",n.recordType=1;var d=new t;d.dateTime="2017-11-03 13：25",d.record="客户表示家人在光大证券做的，要求转去支持，客户不想多个账户，要全部转走后来因为升位，没有转走，挽留客户给了0.6的费率优惠，安抚客户",d.recordType=2;var l=new t;return l.dateTime="2017-11-04 13：25",l.record="好哇",l.recordType=1,e.listRecord.push(n),e.listRecord.push(d),e.listRecord.push(l),e}();n.initData=d,l(),a()},error:function(e,t,o){console.info(e.status),console.info(e.readyState),console.info(t),console.info(o)}})},l=function(){i(),document.body.insertAdjacentHTML("beforeend",n.htmlModal),n.initData.listRecord.forEach(function(t){e.AddRecordHtml(t)}),n.initData.listModel.forEach(function(t){e.AddModelHtml(t)}),modal_create_sms_model.init(n.initData.listModel);var t=new Modal("modal_send_sms","mask1");n.modalNode=t},s=function(){n.modalNode.removeSelf()},a=function(){$("#sms_record").slimScroll({height:"215px;",start:"bottom"});var e=document.getElementById("btn_send_sms");null!==e&&(e.onclick=function(){n.modalNode.show();var e=document.getElementById("sms_record");null!==e&&e.children.length>0&&e.children[e.children.length-1].scrollIntoView()});var t=document.getElementById("btn_cancel_send_sms");null!==t&&(t.onclick=function(){n.modalNode.hide()})},i=function(){var e=['<div id="modal_send_sms">','    <div class="content">','        <p class="p-header">发送短信</p>','        <div id="sms_record">',"        </div>",'        <textarea id="textarea_sms_content" class="font-size-16" placeholder="请输入短信内容......"></textarea>','        <span class="input-footer">剩余字数：','            <span class="text-number">63</span>',"        </span>",'        <div class="row modal-tool-bar">','            <div class="col-50" style="text-align:right">','                <button id="btn_confirm_send_sms" type="button" class="btn disabled" style="margin-right: 10px;">发送</button>',"            </div>",'            <div class="col-50 tool-bar">','                <button id="btn_cancel_send_sms" type="button" class="btn" style="margin-left: 10px;">取消</button>',"                <p>（点此添加短信模板）",'                    <i id="btn_create_sms_model" class="icon-plus"></i>',"                </p>","            </div>","        </div>",'        <div id="model_container_sms">',"        </div>","    </div>","</div>"].join("");n.htmlModal=e};e.AddRecordHtml=function(e){var t=document.getElementById("sms_record");if(null!==t){var o=function(e){var t="";return 1===e.recordType?t=['<div class="record-1">',"    <p>"+e.dateTime+"</p>","    <div>"+e.record+"</div>","</div>"].join(""):2===e.recordType&&(t=['<div class="record-2">',"    <p>"+e.dateTime+"</p>","    <div>"+e.record+"</div>","</div>"].join("")),t}(e);t.insertAdjacentHTML("beforeend",o)}},e.AddModelHtml=function(e){var t=document.getElementById("model_container_sms");if(null!==t){var o=function(e){return['<div class="row">','    <div class="model-sms">',"        "+e,'        <div class="hover-show">','            <div class="triangle"></div>',"            "+e,"        </div>","    </div>",'    <i class="icon-close"></i>',"</div>"].join("")}(e);t.insertAdjacentHTML("beforeend",o)}}}(modal_send_sms||(modal_send_sms={}));var modal_create_sms_model;!function(e){var t={htmlModal:"",modalNode:new Modal("",""),listExistModel:[""],textarea:document.getElementById("textarea_sms_model")};e.init=function(e){t.listExistModel=e,n(),o(),d()};var o=function(){l(),document.body.insertAdjacentHTML("beforeend",t.htmlModal);var e=new Modal("modal_create_sms_model","mask2");t.modalNode=e;var o=document.getElementById("textarea_sms_model");null!==o&&(t.textarea=o)},n=function(){t.modalNode.removeSelf()},d=function(){$("#btn_create_sms_model").on("click",function(){t.listExistModel.length<5&&t.modalNode.show()});$("#btn_cancel_create_sms_model").on("click",function(){t.modalNode.hide()});var e=$("#btn_save_create_sms_model");e.on("click",function(){var e=t.textarea.value;e.length>0&&e.length});var o=$("#left_word_count_sms_model")[0];t.textarea.oninput=function(){var n=t.textarea.value.trim();n.length>0&&n.length<=63?e.removeClass("disabled"):e.addClass("disabled"),o.innerText=(63-n.length).toString()}},l=function(){var e=['<div id="modal_create_sms_model">','    <div class="content">','        <p class="p-header">编辑短信模板</p>','        <textarea id="textarea_sms_model" class="font-size-16" placeholder="请输入短信模板内容......"></textarea>','        <span class="input-footer">剩余字数：','            <span id="left_word_count_sms_model" class="text-number">63</span>',"        </span>",'        <div class="row modal-tool-bar">','            <div class="col-50" style="text-align:right">','                <button id="btn_save_create_sms_model" type="button" class="btn disabled" style="margin-right: 10px;">保存</button>',"            </div>",'            <div class="col-50">','                <button id="btn_cancel_create_sms_model" type="button" class="btn" style="margin-left: 10px;">取消</button>',"            </div>","        </div>","    </div>","</div>"].join("");t.htmlModal=e}}(modal_create_sms_model||(modal_create_sms_model={}));